import{M as Q}from"./MainHeader-8b381d3d.js";import{E as ee,H as te,L as ne,I as oe,a as se}from"./bundle-55987870.js";import{bA as re,o as Y,f as G,b as B,y as A,A as ae,h as ie,C as ce,a as T,w as $,u as C,d as le,Z as ue}from"./app-21f7968e.js";import{u as de}from"./main-268c7f38.js";import{N as he,d as q,a as z}from"./dark-a65a64b8.js";import{N as X}from"./Select-5e1fed67.js";import{N as fe}from"./Button-7a90f843.js";import"./mdi-e7275ea8.js";import"./BaseIcon-e9972e82.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Close-38e401be.js";var Z={},pe={get exports(){return Z},set exports(L){Z=L}};(function(L,K){(function(D,x){L.exports=x()})(self,function(){return(()=>{var D={571:function(u,d){var f,S;f=function(I){var N=function(){function h(c,n){for(var o=0;o<n.length;o++){var a=n[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(c,a.key,a)}}return function(c,n,o){return n&&h(c.prototype,n),o&&h(c,o),c}}(),b=function(){function h(c){(function(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")})(this,h),this.target=c,this.isContentEditable=c&&c.contentEditable}return N(h,[{key:"getPos",value:function(){if(document.activeElement!==this.target)return-1;if(this.isContentEditable){this.target.focus();var c=document.getSelection().getRangeAt(0),n=c.cloneRange();return n.selectNodeContents(this.target),n.setEnd(c.endContainer,c.endOffset),n.toString().length}return this.target.selectionStart}},{key:"setPos",value:function(c){if(this.isContentEditable){if(c>=0){var n=window.getSelection(),o=this.createRange(this.target,{count:c});o&&(o.collapse(!1),n.removeAllRanges(),n.addRange(o))}}else this.target.setSelectionRange(c,c)}},{key:"createRange",value:function(c,n,o){if(o||((o=document.createRange()).selectNode(c),o.setStart(c,0)),n.count===0)o.setEnd(c,n.count);else if(c&&n.count>0)if(c.nodeType===Node.TEXT_NODE)c.textContent.length<n.count?n.count-=c.textContent.length:(o.setEnd(c,n.count),n.count=0);else for(var a=0;a<c.childNodes.length&&(o=this.createRange(c.childNodes[a],n,o),n.count!==0);a++);return o}}]),h}();I.exports=b},(S=f.apply(d,[u]))===void 0||(u.exports=S)},334:(u,d,f)=>{u.exports=f(571)}},x={};function p(u){var d=x[u];if(d!==void 0)return d.exports;var f=x[u]={exports:{}};return D[u].call(f.exports,f,f.exports,p),f.exports}p.n=u=>{var d=u&&u.__esModule?()=>u.default:()=>u;return p.d(d,{a:d}),d},p.d=(u,d)=>{for(var f in d)p.o(d,f)&&!p.o(u,f)&&Object.defineProperty(u,f,{enumerable:!0,get:d[f]})},p.o=(u,d)=>Object.prototype.hasOwnProperty.call(u,d);var k={};return(()=>{p.d(k,{default:()=>c});var u=p(334),d=p.n(u);function f(n,o){for(var a=0;a<o.length;a++){var i=o[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}var S=function(){function n(i,e,t){(function(s,r){if(!(s instanceof r))throw new TypeError("Cannot call a class as a function")})(this,n),this.holder=e,this.observer=null,this.debounceTimer=t,this.mutationDebouncer=this.debounce(function(){i()},this.debounceTimer)}var o,a;return o=n,a=[{key:"setMutationObserver",value:function(){var i=this,e=this.holder.querySelector(".codex-editor__redactor");this.observer=new MutationObserver(function(t){i.mutationHandler(t)}),this.observer.observe(e,{childList:!0,attributes:!0,subtree:!0,characterData:!0,characterDataOldValue:!0})}},{key:"mutationHandler",value:function(i){var e=this,t=!1;i.forEach(function(s){switch(s.type){case"childList":s.target===e.holder?e.onDestroy():t=!0;break;case"characterData":t=!0;break;case"attributes":s.target.classList.contains("ce-block")||s.target.classList.contains("tc-toolbox")||(t=!0)}}),t&&this.mutationDebouncer()}},{key:"debounce",value:function(i,e){var t,s=this;return function(){for(var r=arguments.length,g=new Array(r),y=0;y<r;y++)g[y]=arguments[y];var m=s;clearTimeout(t),t=setTimeout(function(){return i.apply(m,g)},e)}}},{key:"onDestroy",value:function(){var i=new CustomEvent("destroy");document.dispatchEvent(i),this.observer.disconnect()}}],a&&f(o.prototype,a),Object.defineProperty(o,"prototype",{writable:!1}),n}();function I(n,o){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);o&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),a.push.apply(a,i)}return a}function N(n){for(var o=1;o<arguments.length;o++){var a=arguments[o]!=null?arguments[o]:{};o%2?I(Object(a),!0).forEach(function(i){b(n,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(a,i))})}return n}function b(n,o,a){return o in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a,n}function h(n,o){for(var a=0;a<o.length;a++){var i=o[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}var c=function(){function n(e){var t=this,s=e.editor,r=e.config,g=r===void 0?{}:r,y=e.onUpdate,m=e.maxLength;(function(J,H){if(!(J instanceof H))throw new TypeError("Cannot call a class as a function")})(this,n);var v={maxLength:30,onUpdate:function(){},config:{debounceTimer:200,shortcuts:{undo:["CMD+Z"],redo:["CMD+Y","CMD+SHIFT+Z"]}}},_=s.blocks,j=s.caret,E=s.configuration,P=E.holder,W=v.config.shortcuts,F=g.shortcuts,l=N(N({},W),F),U=Array.isArray(l.undo)?l.undo:[l.undo],R=Array.isArray(l.redo)?l.redo:[l.redo],M=v.config.debounceTimer,O=g.debounceTimer,w=O===void 0?M:O;this.holder=typeof P=="string"?document.getElementById(P):P,this.editor=s,this.blocks=_,this.caret=j,this.shouldSaveHistory=!0,this.readOnly=E.readOnly,this.maxLength=m||v.maxLength,this.onUpdate=y||v.onUpdate,this.config={debounceTimer:w,shortcuts:{undo:U,redo:R}},new S(function(){return t.registerChange()},this.holder,this.config.debounceTimer).setMutationObserver(),this.setEventListeners(),this.initialItem=null,this.clear()}var o,a,i;return o=n,i=[{key:"isReadOnlySupported",get:function(){return!0}}],(a=[{key:"truncate",value:function(e,t){for(;e.length>t;)e.shift()}},{key:"initialize",value:function(e){var t="blocks"in e?e.blocks:e,s={index:t.length-1,state:t};this.stack[0]=s,this.initialItem=s}},{key:"clear",value:function(){this.stack=this.initialItem?[this.initialItem]:[{index:0,state:[{type:"paragraph",data:{text:""}}]}],this.position=0,this.onUpdate()}},{key:"setReadOnly",value:function(){var e=document.querySelector(".ce-toolbox");this.readOnly=!e}},{key:"registerChange",value:function(){var e=this;this.setReadOnly(),this.readOnly||(this.editor&&this.editor.save&&this.shouldSaveHistory&&this.editor.save().then(function(t){e.editorDidUpdate(t.blocks)&&e.save(t.blocks)}),this.shouldSaveHistory=!0)}},{key:"editorDidUpdate",value:function(e){var t=this.stack[this.position].state;return!!e.length&&(e.length!==t.length||JSON.stringify(t)!==JSON.stringify(e))}},{key:"save",value:function(e){this.position>=this.maxLength&&this.truncate(this.stack,this.maxLength),this.position=Math.min(this.position,this.stack.length-1),this.stack=this.stack.slice(0,this.position+1);var t=this.blocks.getCurrentBlockIndex(),s=this.blocks.getBlocksCount(),r=t;e[t]||(r-=s-e.length);var g=!e[r]||e[r].type!=="paragraph"&&e[r].type!=="header"?null:this.getCaretIndex(t);this.stack.push({index:r,state:e,caretIndex:g}),this.position+=1,this.onUpdate()}},{key:"getCaretIndex",value:function(e){var t=document.getElementsByClassName("ce-block__content");return new(d())(t[e].firstChild).getPos()}},{key:"insertDeletedBlock",value:function(e,t,s){for(var r=0;r<e.length;r+=1)if(!t[r]||e[r].id!==t[r].id){this.blocks.insert(e[r].type,e[r].data,{},r,!0),this.caret.setToBlock(s,"end");break}}},{key:"blockWasDropped",value:function(e,t){return e.length===t.length&&e.some(function(s,r){return s.id!==t[r].id})}},{key:"blockWasSkipped",value:function(e,t,s,r){return e<t&&s.length!==r.length}},{key:"contentChangedInNoFocusBlock",value:function(e,t){return e!==t}},{key:"blockWasDeleted",value:function(e,t){return e.length>t.length}},{key:"undo",value:function(){var e=this;if(this.canUndo()&&this.position>=0){this.position-=1,this.shouldSaveHistory=!1;var t=this.stack[this.position].index,s=this.stack[this.position],r=s.state,g=s.caretIndex,y=this.stack[this.position],m=y.index,v=y.state;this.onUpdate();var _=this.blocks.getBlocksCount();if(r[t]||(t-=1,this.stack[this.position].index=t),this.blockWasDeleted(r,v))this.insertDeletedBlock(r,v,t);else if(this.blockWasSkipped(t,m,r,v))this.blocks.delete(),this.caret.setToBlock(t,"end");else if(_>r.length)this.blocks.render({blocks:r}).then(function(){e.editor.blocks.insert("paragraph",{text:""}),e.caret.setToLastBlock("end")});else if(this.blockWasDropped(r,v))this.blocks.render({blocks:r}).then(function(){return e.caret.setToBlock(t,"end")});else if(this.contentChangedInNoFocusBlock(t,m)){var j=this.blocks.getBlockByIndex(m).id;this.blocks.update(j,r[m].data),this.setCaretIndex(t,g)}var E=this.blocks.getBlockByIndex(t);E&&(this.blocks.update(E.id,r[t].data),this.setCaretIndex(t,g))}}},{key:"setCaretIndex",value:function(e,t){if(t&&t!==-1){var s=document.getElementsByClassName("ce-block__content");new(d())(s[e].firstChild).setPos(t)}else this.caret.setToBlock(e,"end")}},{key:"insertBlock",value:function(e,t){this.blocks.insert(e[t].type,e[t].data,{},t,!0)}},{key:"insertSkippedBlocks",value:function(e,t){for(var s=e;s<t.length;s+=1)this.insertBlock(t,s)}},{key:"redo",value:function(){var e=this;if(this.canRedo()){this.position+=1,this.shouldSaveHistory=!1;var t=this.stack[this.position],s=t.index,r=t.state,g=t.caretIndex,y=this.stack[this.position-1],m=y.index,v=y.state;this.blockWasDeleted(v,r)?(this.blocks.delete(),this.caret.setToBlock(s,"end")):this.blockWasSkipped(m,s,r,v)?(this.insertSkippedBlocks(v.length,r),this.caret.setToBlock(s,"end")):this.blockWasDropped(r,v)&&this.position!==1&&this.blocks.render({blocks:r}).then(function(){return e.caret.setToBlock(s,"end")}),this.onUpdate();var _=this.blocks.getBlockByIndex(s);_&&(this.blocks.update(_.id,r[s].data),this.setCaretIndex(s,g))}}},{key:"canUndo",value:function(){return!this.readOnly&&this.position>0}},{key:"canRedo",value:function(){return!this.readOnly&&this.position<this.count()}},{key:"count",value:function(){return this.stack.length-1}},{key:"parseKeys",value:function(e){var t={CMD:/(Mac)/i.test(navigator.platform)?"metaKey":"ctrlKey",ALT:"altKey",SHIFT:"shiftKey"},s=e.slice(0,-1).map(function(g){return t[g]}),r=s.includes("shiftKey")&&e.length===2?e[e.length-1].toUpperCase():e[e.length-1].toLowerCase();return s.push(r),s}},{key:"setEventListeners",value:function(){var e=this,t=this.holder,s=this.config.shortcuts,r=s.undo,g=s.redo,y=r.map(function(l){return l.replace(/ /g,"").split("+")}),m=g.map(function(l){return l.replace(/ /g,"").split("+")}),v=y.map(function(l){return e.parseKeys(l)}),_=m.map(function(l){return e.parseKeys(l)}),j=function(l){return l.replace("Key","").toLowerCase()},E=function(l,U){return U.reduce(function(R,M){return R||function(O,w){return w.length===3&&O[w[0]]&&O[w[1]]&&(O.key===w[2]||j(O.code)===w[2])}(l,M)},!1)},P=function(l,U,R){return!(!function(M,O){return O.reduce(function(w,J){return w||function(H,V){return V.length===2&&H[V[0]]&&(H.key===V[1]||j(H.code)===V[1])}(M,J)},!1)}(l,U)||E(l,R))||!!E(l,U)},W=function(l){P(l,v,_)&&(l.preventDefault(),e.undo())},F=function(l){P(l,_,v)&&(l.preventDefault(),e.redo())};t.addEventListener("keydown",W),t.addEventListener("keydown",F),t.addEventListener("destroy",function(){t.removeEventListener("keydown",W),t.removeEventListener("keydown",F)})}}])&&h(o.prototype,a),i&&h(o,i),Object.defineProperty(o,"prototype",{writable:!1}),n}()})(),k.default})()})})(pe);const ve=re(Z);const ge={class:"my-6 rounded ring ring-gray-600"},ye=B("div",{id:"editorjs",class:"text-white"},null,-1),ke=[ye],be={__name:"NeoEditor",emits:["saveData"],setup(L,{expose:K,emit:D}){const x=new ee({holder:"editorjs",tools:{paragraph:{config:{placeholder:"Tell your story..."}},header:{class:te,config:{placeholder:"Enter a header",levels:[2,3,4],defaultLevel:3}},list:{class:ne,inlineToolbar:!0},image:{class:oe,config:{endpoints:{byFile:"http://localhost:8000/main/thread/uploadFile"}}},linkTool:{class:se,config:{endpoint:"http://localhost:8000/main/thread/fetchUrl"}}},plugins:[],onReady:()=>{new ve({editor:x})}});return K({saveData:()=>{x.save().then(k=>{D("saveData",k)}).catch(k=>{console.log("Saving failed:",k)})}}),(k,u)=>(Y(),G("div",ge,ke))}};const me={class:"headerMover bg-mine-second rounded"},xe={class:"w-full p-6"},_e=B("h1",{class:"text-white bold text-lg"},"Վերնագիր։ ",-1),Oe=B("h3",{class:"text-white"},"Մի քանի բառով ձևակերպեք, թե ինչի մասին է ձեր թեման ",-1),we=B("div",{class:"h-6"},null,-1),Ue={__name:"Thread",props:{auth:Object},setup(L){const K=L,D=A(),x=A(""),p=A(null),k=A(null),u=de();ae(async()=>{await u.fetchSlideList()});const d=ie(()=>u.slideList.map(function(b){return{label:b.name,value:b.id}})),f=A({}),S=()=>{p.value!==null&&(f.value=u.slideList[p.value-1].subcategories.map(b=>({label:b.name,value:b.id})).reverse(),k.value=null)};ce(p,S);const I=b=>{ue.post(route("thread.store"),{title:x.value,category:p.value,subcategory:k.value,body:JSON.stringify(b)}).then(h=>console.log(h)).catch(h=>console.log(h))},N=()=>{D.value.saveData()};return(b,h)=>(Y(),G("main",null,[T(Q,{auth:K.auth},null,8,["auth"]),B("section",me,[B("div",xe,[_e,Oe,T(C(z),{theme:C(q)},{default:$(()=>[T(C(he),{value:x.value,"onUpdate:value":h[0]||(h[0]=c=>x.value=c),placeholder:"Thread title",class:"mt-2"},null,8,["value"])]),_:1},8,["theme"]),T(be,{ref_key:"editorRef",ref:D,onSaveData:I},null,512),T(C(z),{theme:C(q)},{default:$(()=>[T(C(X),{value:p.value,"onUpdate:value":h[1]||(h[1]=c=>p.value=c),options:C(d),placeholder:"Select category",onUpdateValue:S},null,8,["value","options"]),T(C(X),{options:f.value,value:k.value,"onUpdate:value":h[2]||(h[2]=c=>k.value=c),placeholder:"Select subcategory",class:"my-6"},null,8,["options","value"]),B("div",null,[T(C(fe),{type:"primary",ghost:"","on-click":N},{default:$(()=>[le("Save your thread")]),_:1})])]),_:1},8,["theme"])])]),we]))}};export{Ue as default};
